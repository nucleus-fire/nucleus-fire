#![allow(unused_imports)]
        use axum::{response::{Html, IntoResponse}, routing::get, extract::{Query, Form}, Router};
        use tower_http::services::ServeDir;
        use tokio::net::TcpListener;
        use serde::{Serialize, Deserialize};
        
        // --- Static Assets (Zero-Allocation) ---
        #[allow(non_snake_case, unreachable_code, unused_variables)]
async fn handle_discover(headers: axum::http::HeaderMap, Query(params): Query<std::collections::HashMap<String, String>>) -> impl axum::response::IntoResponse {

    
    let mut html_body = String::new();
html_body.push_str("<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>Discover Matches</title><meta name=\"description\" content=\"Built with Nucleus\"></head><body>");
html_body.push_str("<div");
html_body.push_str(" class=\"min-h-screen bg-brand-navy font-sans overflow-hidden flex flex-col\"");
html_body.push('>');
html_body.push_str("<!-- Top Nav -->");
html_body.push_str("<header");
html_body.push_str(" class=\"h-16 flex items-center justify-between px-6 glass z-50\"");
html_body.push('>');
html_body.push_str("<a");
html_body.push_str(" href=\"/\"");
html_body.push_str(" class=\"text-brand-rose font-bold text-xl\"");
html_body.push('>');
html_body.push_str("Amour");
html_body.push_str("</a>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex gap-4\"");
html_body.push('>');
html_body.push_str("<a");
html_body.push_str(" href=\"/app/chat\"");
html_body.push_str(" class=\"p-2 text-gray-400 hover:text-white transition-colors\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-6 h-6\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"2\"");
html_body.push_str(" d=\"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</a>");
html_body.push_str("<a");
html_body.push_str(" href=\"/app/profile\"");
html_body.push_str(" class=\"p-2 text-gray-400 hover:text-white transition-colors\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-6 h-6\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"2\"");
html_body.push_str(" d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</a>");
html_body.push_str("</div>");
html_body.push_str("</header>");
html_body.push_str("<!-- Card Stack Container -->");
html_body.push_str("<main");
html_body.push_str(" class=\"flex-1 flex items-center justify-center relative w-full max-w-md mx-auto p-4\"");
html_body.push('>');
html_body.push_str("<!-- Background Pulse -->");
html_body.push_str("<div");
html_body.push_str(" class=\"absolute w-[500px] h-[500px] bg-brand-rose/10 blur-[100px] rounded-full -z-10 animate-pulse\"");
html_body.push('>');
html_body.push_str("</div>");
html_body.push_str("<!-- Empty State (behind cards) -->");
html_body.push_str("<div");
html_body.push_str(" class=\"absolute inset-0 flex items-center justify-center text-gray-500 z-0\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"text-center\"");
html_body.push('>');
html_body.push_str("<p");
html_body.push_str(" class=\"mb-4\"");
html_body.push('>');
html_body.push_str("No more profiles nearby.");
html_body.push_str("</p>");
html_body.push_str("<button");
html_body.push_str(" class=\"px-6 py-2 border border-white/20 rounded-full hover:bg-white/5 transition-colors text-sm\"");
html_body.push('>');
html_body.push_str("Update Preferences");
html_body.push_str("</button>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<!-- Profile Card (Top) -->");
html_body.push_str("<div");
html_body.push_str(" id=\"card-stack\"");
html_body.push_str(" class=\"relative w-full aspect-[3/4] z-10\"");
html_body.push('>');
html_body.push_str("<!-- Mock Data Logic would inject cards here -->");
html_body.push_str("<div");
html_body.push_str(" class=\"absolute inset-0 w-full h-full bg-white rounded-3xl overflow-hidden shadow-2xl transform transition-transform duration-300 hover:scale-[1.02] cursor-grab active:cursor-grabbing\"");
html_body.push('>');
html_body.push_str("<img");
html_body.push_str(" src=\"https://images.unsplash.com/photo-1517841905240-472988babdf9?w=800&q=80\"");
html_body.push_str(" alt=\"Profile\"");
html_body.push_str(" class=\"w-full h-full object-cover\"");
html_body.push('>');
html_body.push_str("</img>");
html_body.push_str("<div");
html_body.push_str(" class=\"absolute bottom-0 inset-x-0 h-1/2 bg-gradient-to-t from-black/90 via-black/40 to-transparent p-6 flex flex-col justify-end\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"flex items-end justify-between\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push('>');
html_body.push_str("<h2");
html_body.push_str(" class=\"text-3xl font-bold text-white\"");
html_body.push('>');
html_body.push_str("Sarah, 24");
html_body.push_str("</h2>");
html_body.push_str("<p");
html_body.push_str(" class=\"text-white/80 text-sm mt-1\"");
html_body.push('>');
html_body.push_str("Interior Designer • 2 miles away");
html_body.push_str("</p>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"w-10 h-10 rounded-full border border-white/30 flex items-center justify-center text-white/80\"");
html_body.push('>');
html_body.push_str("ℹ\u{fe0f}\n                            ");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex gap-2 mt-4 flex-wrap\"");
html_body.push('>');
html_body.push_str("<span");
html_body.push_str(" class=\"px-3 py-1 rounded-full bg-white/10 backdrop-blur-sm text-xs text-white border border-white/10\"");
html_body.push('>');
html_body.push_str("Art");
html_body.push_str("</span>");
html_body.push_str("<span");
html_body.push_str(" class=\"px-3 py-1 rounded-full bg-white/10 backdrop-blur-sm text-xs text-white border border-white/10\"");
html_body.push('>');
html_body.push_str("Coffee");
html_body.push_str("</span>");
html_body.push_str("<span");
html_body.push_str(" class=\"px-3 py-1 rounded-full bg-white/10 backdrop-blur-sm text-xs text-white border border-white/10\"");
html_body.push('>');
html_body.push_str("Travel");
html_body.push_str("</span>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</main>");
html_body.push_str("<!-- Action Bar -->");
html_body.push_str("<footer");
html_body.push_str(" class=\"h-24 flex items-center justify-center gap-8 pb-4\"");
html_body.push('>');
html_body.push_str("<button");
html_body.push_str(" class=\"w-14 h-14 rounded-full bg-gray-800 text-brand-rose border border-gray-700 hover:bg-gray-700 hover:scale-110 transition-all flex items-center justify-center shadow-lg\"");
html_body.push_str(" aria-label=\"Pass\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-8 h-8\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"3\"");
html_body.push_str(" d=\"M6 18L18 6M6 6l12 12\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</button>");
html_body.push_str("<button");
html_body.push_str(" class=\"w-16 h-16 rounded-full bg-gradient-to-tr from-brand-rose to-brand-gold text-white hover:scale-110 hover:shadow-brand-rose/50 hover:shadow-xl transition-all flex items-center justify-center shadow-lg\"");
html_body.push_str(" aria-label=\"Like\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-8 h-8\"");
html_body.push_str(" fill=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</button>");
html_body.push_str("<button");
html_body.push_str(" class=\"w-12 h-12 rounded-full bg-gray-800 text-brand-gold border border-gray-700 hover:bg-gray-700 hover:scale-110 transition-all flex items-center justify-center shadow-lg\"");
html_body.push_str(" aria-label=\"Super Like\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-6 h-6\"");
html_body.push_str(" fill=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" d=\"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</button>");
html_body.push_str("</footer>");
html_body.push_str("</div>");
html_body.push_str("</body></html>");

    axum::response::Html(html_body).into_response()
}

#[allow(non_snake_case, unreachable_code, unused_variables)]
async fn handle_chat(headers: axum::http::HeaderMap, Query(params): Query<std::collections::HashMap<String, String>>) -> impl axum::response::IntoResponse {

    
    let mut html_body = String::new();
html_body.push_str("<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>Messages</title><meta name=\"description\" content=\"Built with Nucleus\"></head><body>");
html_body.push_str("<div");
html_body.push_str(" class=\"h-screen bg-brand-navy flex overflow-hidden font-sans\"");
html_body.push('>');
html_body.push_str("<!-- Sidebar -->");
html_body.push_str("<aside");
html_body.push_str(" class=\"w-80 border-r border-white/10 flex flex-col glass z-10\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"h-16 flex items-center justify-between px-6 border-b border-white/10\"");
html_body.push('>');
html_body.push_str("<h1");
html_body.push_str(" class=\"text-white font-bold text-lg\"");
html_body.push('>');
html_body.push_str("Matches");
html_body.push_str("</h1>");
html_body.push_str("<a");
html_body.push_str(" href=\"/app/discover\"");
html_body.push_str(" class=\"text-brand-rose text-sm font-medium hover:text-white\"");
html_body.push('>');
html_body.push_str("Discover");
html_body.push_str("</a>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex-1 overflow-y-auto p-4 space-y-2\"");
html_body.push('>');
html_body.push_str("<!-- Active Chat -->");
html_body.push_str("<div");
html_body.push_str(" class=\"p-3 rounded-xl bg-white/10 border border-white/5 cursor-pointer flex items-center gap-3\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"relative\"");
html_body.push('>');
html_body.push_str("<img");
html_body.push_str(" src=\"https://images.unsplash.com/photo-1517841905240-472988babdf9?w=100&q=80\"");
html_body.push_str(" class=\"w-12 h-12 rounded-full object-cover\"");
html_body.push_str(" alt=\"Sarah's Avatar\"");
html_body.push('>');
html_body.push_str("</img>");
html_body.push_str("<div");
html_body.push_str(" class=\"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-brand-navy\"");
html_body.push('>');
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex-1 min-w-0\"");
html_body.push('>');
html_body.push_str("<h3");
html_body.push_str(" class=\"text-white font-medium truncate\"");
html_body.push('>');
html_body.push_str("Sarah");
html_body.push_str("</h3>");
html_body.push_str("<p");
html_body.push_str(" class=\"text-gray-400 text-sm truncate\"");
html_body.push('>');
html_body.push_str("See you at 8! ☕\u{fe0f}");
html_body.push_str("</p>");
html_body.push_str("</div>");
html_body.push_str("<span");
html_body.push_str(" class=\"text-xs text-gray-500\"");
html_body.push('>');
html_body.push_str("2m");
html_body.push_str("</span>");
html_body.push_str("</div>");
html_body.push_str("<!-- Inactive Chat -->");
html_body.push_str("<div");
html_body.push_str(" class=\"p-3 rounded-xl hover:bg-white/5 cursor-pointer flex items-center gap-3 transition-colors\"");
html_body.push('>');
html_body.push_str("<img");
html_body.push_str(" src=\"https://images.unsplash.com/photo-1539571696357-5a69c17a67c6?w=100&q=80\"");
html_body.push_str(" class=\"w-12 h-12 rounded-full object-cover grayscale opacity-70\"");
html_body.push_str(" alt=\"Michael's Avatar\"");
html_body.push('>');
html_body.push_str("</img>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex-1 min-w-0\"");
html_body.push('>');
html_body.push_str("<h3");
html_body.push_str(" class=\"text-gray-300 font-medium truncate\"");
html_body.push('>');
html_body.push_str("Michael");
html_body.push_str("</h3>");
html_body.push_str("<p");
html_body.push_str(" class=\"text-gray-500 text-sm truncate\"");
html_body.push('>');
html_body.push_str("Matched on Thursday");
html_body.push_str("</p>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</aside>");
html_body.push_str("<!-- Chat Area -->");
html_body.push_str("<main");
html_body.push_str(" class=\"flex-1 flex flex-col relative bg-gradient-to-br from-brand-navy to-black\"");
html_body.push('>');
html_body.push_str("<!-- Header -->");
html_body.push_str("<header");
html_body.push_str(" class=\"h-16 border-b border-white/10 flex items-center justify-between px-6 glass\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"flex items-center gap-3\"");
html_body.push('>');
html_body.push_str("<img");
html_body.push_str(" src=\"https://images.unsplash.com/photo-1517841905240-472988babdf9?w=100&q=80\"");
html_body.push_str(" class=\"w-10 h-10 rounded-full object-cover\"");
html_body.push_str(" alt=\"Sarah Profile\"");
html_body.push('>');
html_body.push_str("</img>");
html_body.push_str("<div");
html_body.push('>');
html_body.push_str("<h2");
html_body.push_str(" class=\"text-white font-bold text-sm\"");
html_body.push('>');
html_body.push_str("Sarah");
html_body.push_str("</h2>");
html_body.push_str("<span");
html_body.push_str(" class=\"text-green-500 text-xs flex items-center gap-1\"");
html_body.push('>');
html_body.push_str("● Online");
html_body.push_str("</span>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<button");
html_body.push_str(" class=\"text-gray-400 hover:text-white\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-6 h-6\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"2\"");
html_body.push_str(" d=\"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</button>");
html_body.push_str("</header>");
html_body.push_str("<!-- Messages -->");
html_body.push_str("<div");
html_body.push_str(" class=\"flex-1 overflow-y-auto p-6 space-y-6\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"flex justify-center\"");
html_body.push('>');
html_body.push_str("<span");
html_body.push_str(" class=\"text-xs text-gray-500 bg-white/5 px-3 py-1 rounded-full\"");
html_body.push('>');
html_body.push_str("Today");
html_body.push_str("</span>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex items-end gap-2\"");
html_body.push('>');
html_body.push_str("<img");
html_body.push_str(" src=\"https://images.unsplash.com/photo-1517841905240-472988babdf9?w=100&q=80\"");
html_body.push_str(" class=\"w-8 h-8 rounded-full object-cover mb-1\"");
html_body.push_str(" alt=\"Sarah\"");
html_body.push('>');
html_body.push_str("</img>");
html_body.push_str("<div");
html_body.push_str(" class=\"bg-white/10 text-white px-4 py-2 rounded-2xl rounded-bl-none max-w-md\"");
html_body.push('>');
html_body.push_str("Hey! I noticed you like coffee. Have you tried the new place downtown?\n                    ");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex items-end gap-2 flex-row-reverse\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"bg-brand-rose text-white px-4 py-2 rounded-2xl rounded-br-none max-w-md\"");
html_body.push('>');
html_body.push_str("The one on 4th street? I was actually planning to go there today!\n                    ");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex items-end gap-2\"");
html_body.push('>');
html_body.push_str("<img");
html_body.push_str(" src=\"https://images.unsplash.com/photo-1517841905240-472988babdf9?w=100&q=80\"");
html_body.push_str(" class=\"w-8 h-8 rounded-full object-cover mb-1\"");
html_body.push_str(" alt=\"Sarah\"");
html_body.push('>');
html_body.push_str("</img>");
html_body.push_str("<div");
html_body.push_str(" class=\"bg-white/10 text-white px-4 py-2 rounded-2xl rounded-bl-none max-w-md\"");
html_body.push('>');
html_body.push_str("No way! Want to meet there around 8?\n                    ");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex items-end gap-2 flex-row-reverse\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"bg-brand-rose text-white px-4 py-2 rounded-2xl rounded-br-none max-w-md\"");
html_body.push('>');
html_body.push_str("See you at 8! ☕\u{fe0f}\n                    ");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<!-- Input -->");
html_body.push_str("<div");
html_body.push_str(" class=\"p-4 border-t border-white/10 glass\"");
html_body.push('>');
html_body.push_str("<form");
html_body.push_str(" class=\"flex gap-2\"");
html_body.push('>');
html_body.push_str("<button");
html_body.push_str(" type=\"button\"");
html_body.push_str(" class=\"p-3 text-gray-400 hover:text-white rounded-full hover:bg-white/5 transition-colors\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-6 h-6\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"2\"");
html_body.push_str(" d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</button>");
html_body.push_str("<input");
html_body.push_str(" type=\"text\"");
html_body.push_str(" placeholder=\"Type a message...\"");
html_body.push_str(" class=\"flex-1 bg-white/5 border border-white/10 rounded-full px-6 text-white placeholder-gray-500 focus:outline-none focus:border-brand-rose focus:ring-1 focus:ring-brand-rose transition-all\"");
html_body.push('>');
html_body.push_str("</input>");
html_body.push_str("<button");
html_body.push_str(" type=\"submit\"");
html_body.push_str(" class=\"p-3 bg-brand-rose text-white rounded-full hover:bg-brand-rose/90 transition-colors shadow-lg\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-6 h-6\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"2\"");
html_body.push_str(" d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</button>");
html_body.push_str("</form>");
html_body.push_str("</div>");
html_body.push_str("</main>");
html_body.push_str("</div>");
html_body.push_str("</body></html>");

    axum::response::Html(html_body).into_response()
}

#[allow(non_snake_case, unreachable_code, unused_variables)]
async fn handle_profile(headers: axum::http::HeaderMap, Query(params): Query<std::collections::HashMap<String, String>>) -> impl axum::response::IntoResponse {

    
    let mut html_body = String::new();
html_body.push_str("<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>My Profile</title><meta name=\"description\" content=\"Built with Nucleus\"></head><body>");
html_body.push_str("<div");
html_body.push_str(" class=\"min-h-screen bg-brand-navy font-sans text-white pb-20\"");
html_body.push('>');
html_body.push_str("<!-- Header -->");
html_body.push_str("<header");
html_body.push_str(" class=\"h-16 flex items-center justify-between px-6 border-b border-white/10 bg-brand-navy/80 backdrop-blur sticky top-0 z-50\"");
html_body.push('>');
html_body.push_str("<a");
html_body.push_str(" href=\"/app/discover\"");
html_body.push_str(" class=\"text-gray-400 hover:text-white\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-6 h-6\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"2\"");
html_body.push_str(" d=\"M15 19l-7-7 7-7\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</a>");
html_body.push_str("<h1");
html_body.push_str(" class=\"font-bold text-lg\"");
html_body.push('>');
html_body.push_str("Edit Profile");
html_body.push_str("</h1>");
html_body.push_str("<button");
html_body.push_str(" class=\"text-brand-rose font-medium text-sm\"");
html_body.push('>');
html_body.push_str("Save");
html_body.push_str("</button>");
html_body.push_str("</header>");
html_body.push_str("<!-- Content -->");
html_body.push_str("<main");
html_body.push_str(" class=\"max-w-2xl mx-auto p-6 space-y-8 animate-fade-in\"");
html_body.push('>');
html_body.push_str("<!-- Photos -->");
html_body.push_str("<section");
html_body.push_str(" class=\"space-y-4\"");
html_body.push('>');
html_body.push_str("<h2");
html_body.push_str(" class=\"text-sm font-bold text-gray-500 uppercase tracking-wider\"");
html_body.push('>');
html_body.push_str("Photos");
html_body.push_str("</h2>");
html_body.push_str("<div");
html_body.push_str(" class=\"grid grid-cols-3 gap-4\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"aspect-[2/3] bg-white/10 rounded-xl overflow-hidden relative group cursor-pointer border border-white/10 hover:border-brand-rose/50 transition-colors\"");
html_body.push('>');
html_body.push_str("<img");
html_body.push_str(" src=\"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=400&q=80\"");
html_body.push_str(" class=\"w-full h-full object-cover\"");
html_body.push_str(" alt=\"My Profile Photo 1\"");
html_body.push('>');
html_body.push_str("</img>");
html_body.push_str("<div");
html_body.push_str(" class=\"absolute bottom-2 right-2 bg-black/50 p-1 rounded-full text-white cursor-pointer hover:bg-red-500 transition-colors\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-4 h-4\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"2\"");
html_body.push_str(" d=\"M6 18L18 6M6 6l12 12\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"aspect-[2/3] bg-white/5 rounded-xl border-2 border-dashed border-white/20 flex flex-col items-center justify-center text-gray-500 hover:border-brand-rose/50 hover:text-brand-rose hover:bg-brand-rose/5 transition-all cursor-pointer\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-8 h-8 mb-2\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"2\"");
html_body.push_str(" d=\"M12 4v16m8-8H4\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("<span");
html_body.push_str(" class=\"text-xs font-medium\"");
html_body.push('>');
html_body.push_str("Add Photo");
html_body.push_str("</span>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"aspect-[2/3] bg-white/5 rounded-xl border-2 border-dashed border-white/20 flex flex-col items-center justify-center text-gray-500 hover:border-brand-rose/50 hover:text-brand-rose hover:bg-brand-rose/5 transition-all cursor-pointer\"");
html_body.push('>');
html_body.push_str("<svg");
html_body.push_str(" class=\"w-8 h-8 mb-2\"");
html_body.push_str(" fill=\"none\"");
html_body.push_str(" stroke=\"currentColor\"");
html_body.push_str(" viewBox=\"0 0 24 24\"");
html_body.push('>');
html_body.push_str("<path");
html_body.push_str(" stroke-linecap=\"round\"");
html_body.push_str(" stroke-linejoin=\"round\"");
html_body.push_str(" stroke-width=\"2\"");
html_body.push_str(" d=\"M12 4v16m8-8H4\"");
html_body.push('>');
html_body.push_str("</path>");
html_body.push_str("</svg>");
html_body.push_str("<span");
html_body.push_str(" class=\"text-xs font-medium\"");
html_body.push('>');
html_body.push_str("Add Photo");
html_body.push_str("</span>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</section>");
html_body.push_str("<!-- Bio -->");
html_body.push_str("<section");
html_body.push_str(" class=\"space-y-4\"");
html_body.push('>');
html_body.push_str("<h2");
html_body.push_str(" class=\"text-sm font-bold text-gray-500 uppercase tracking-wider\"");
html_body.push('>');
html_body.push_str("About Me");
html_body.push_str("</h2>");
html_body.push_str("<div");
html_body.push_str(" class=\"relative\"");
html_body.push('>');
html_body.push_str("<textarea");
html_body.push_str(" class=\"w-full bg-white/5 border border-white/10 rounded-xl p-4 text-white placeholder-gray-500 focus:outline-none focus:border-brand-rose focus:ring-1 focus:ring-brand-rose transition-all resize-none h-32\"");
html_body.push_str(" placeholder=\"Write something about yourself...\"");
html_body.push('>');
html_body.push_str("</textarea>");
html_body.push_str("<span");
html_body.push_str(" class=\"absolute bottom-4 right-4 text-xs text-gray-500\"");
html_body.push('>');
html_body.push_str("0/500");
html_body.push_str("</span>");
html_body.push_str("</div>");
html_body.push_str("</section>");
html_body.push_str("<!-- Details -->");
html_body.push_str("<section");
html_body.push_str(" class=\"space-y-4\"");
html_body.push('>');
html_body.push_str("<h2");
html_body.push_str(" class=\"text-sm font-bold text-gray-500 uppercase tracking-wider\"");
html_body.push('>');
html_body.push_str("Details");
html_body.push_str("</h2>");
html_body.push_str("<div");
html_body.push_str(" class=\"space-y-4\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push('>');
html_body.push_str("<label");
html_body.push_str(" class=\"block text-xs text-gray-400 mb-1\"");
html_body.push('>');
html_body.push_str("Job Title");
html_body.push_str("</label>");
html_body.push_str("<input");
html_body.push_str(" type=\"text\"");
html_body.push_str(" value=\"Product Designer\"");
html_body.push_str(" aria-label=\"Job Title\"");
html_body.push_str(" class=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-rose transition-all\"");
html_body.push('>');
html_body.push_str("</input>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push('>');
html_body.push_str("<label");
html_body.push_str(" class=\"block text-xs text-gray-400 mb-1\"");
html_body.push('>');
html_body.push_str("Company");
html_body.push_str("</label>");
html_body.push_str("<input");
html_body.push_str(" type=\"text\"");
html_body.push_str(" value=\"Nucleus Inc.\"");
html_body.push_str(" aria-label=\"Company\"");
html_body.push_str(" class=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-rose transition-all\"");
html_body.push('>');
html_body.push_str("</input>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push('>');
html_body.push_str("<label");
html_body.push_str(" class=\"block text-xs text-gray-400 mb-1\"");
html_body.push('>');
html_body.push_str("School");
html_body.push_str("</label>");
html_body.push_str("<input");
html_body.push_str(" type=\"text\"");
html_body.push_str(" placeholder=\"Add school\"");
html_body.push_str(" aria-label=\"School\"");
html_body.push_str(" class=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-brand-rose transition-all\"");
html_body.push('>');
html_body.push_str("</input>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</section>");
html_body.push_str("</main>");
html_body.push_str("</div>");
html_body.push_str("</body></html>");

    axum::response::Html(html_body).into_response()
}

#[allow(non_snake_case, unreachable_code, unused_variables)]
async fn handle_index(headers: axum::http::HeaderMap, Query(params): Query<std::collections::HashMap<String, String>>) -> impl axum::response::IntoResponse {

    
    let mut html_body = String::new();
html_body.push_str("<!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>Amour - Find True Love</title><meta name=\"description\" content=\"Built with Nucleus\"></head><body>");
html_body.push_str("<div");
html_body.push_str(" class=\"min-h-screen bg-brand-navy text-white font-sans overflow-x-hidden selection:bg-brand-rose selection:text-white\"");
html_body.push('>');
html_body.push_str("<!-- Navigation -->");
html_body.push_str("<nav");
html_body.push_str(" class=\"fixed w-full z-50 transition-all duration-300 glass\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"max-w-7xl mx-auto px-6 h-20 flex items-center justify-between\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"flex items-center gap-2\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"w-8 h-8 rounded-full bg-gradient-to-tr from-brand-rose to-brand-gold\"");
html_body.push('>');
html_body.push_str("</div>");
html_body.push_str("<span");
html_body.push_str(" class=\"text-2xl font-bold tracking-tight\"");
html_body.push('>');
html_body.push_str("Amour");
html_body.push_str("</span>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"hidden md:flex items-center gap-8\"");
html_body.push('>');
html_body.push_str("<a");
html_body.push_str(" href=\"#features\"");
html_body.push_str(" class=\"text-sm font-medium text-gray-300 hover:text-white transition-colors\"");
html_body.push('>');
html_body.push_str("Stories");
html_body.push_str("</a>");
html_body.push_str("<a");
html_body.push_str(" href=\"#safety\"");
html_body.push_str(" class=\"text-sm font-medium text-gray-300 hover:text-white transition-colors\"");
html_body.push('>');
html_body.push_str("Safety");
html_body.push_str("</a>");
html_body.push_str("<a");
html_body.push_str(" href=\"/login\"");
html_body.push_str(" class=\"px-6 py-2 rounded-full border border-white/20 hover:bg-white/10 transition-all text-sm font-medium\"");
html_body.push('>');
html_body.push_str("Log in");
html_body.push_str("</a>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</nav>");
html_body.push_str("<!-- Hero Section -->");
html_body.push_str("<main");
html_body.push_str(" class=\"relative pt-32 pb-20 lg:pt-48 lg:pb-32 px-6\"");
html_body.push('>');
html_body.push_str("<!-- Ambient Background Glow -->");
html_body.push_str("<div");
html_body.push_str(" class=\"absolute top-0 left-1/2 -translate-x-1/2 w-full h-[800px] bg-brand-rose/20 blur-[120px] rounded-full pointer-events-none -z-10 mix-blend-screen\"");
html_body.push('>');
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"max-w-4xl mx-auto text-center space-y-8 animate-fade-in\"");
html_body.push('>');
html_body.push_str("<h1");
html_body.push_str(" class=\"text-5xl md:text-7xl font-bold tracking-tight leading-tight\"");
html_body.push('>');
html_body.push_str("Dating deserving of ");
html_body.push_str("<br");
html_body.push('>');
html_body.push_str("</br>");
html_body.push_str("<span");
html_body.push_str(" class=\"text-transparent bg-clip-text bg-gradient-to-r from-brand-rose to-brand-gold\"");
html_body.push('>');
html_body.push_str("your standards.");
html_body.push_str("</span>");
html_body.push_str("</h1>");
html_body.push_str("<p");
html_body.push_str(" class=\"text-lg md:text-xl text-gray-400 max-w-2xl mx-auto leading-relaxed\"");
html_body.push('>');
html_body.push_str("Designed for meaningful connections. No endless swiping, just curated matches \n                    based on what truly matters to you.\n                ");
html_body.push_str("</p>");
html_body.push_str("<div");
html_body.push_str(" class=\"flex flex-col sm:flex-row items-center justify-center gap-4 pt-4 animate-slide-up\"");
html_body.push('>');
html_body.push_str("<a");
html_body.push_str(" href=\"/app/discover\"");
html_body.push_str(" class=\"group relative px-8 py-4 bg-white text-brand-navy rounded-full font-bold text-lg hover:shadow-[0_0_40px_-10px_rgba(255,255,255,0.3)] transition-all\"");
html_body.push('>');
html_body.push_str("Start Matching\n                        ");
html_body.push_str("<span");
html_body.push_str(" class=\"absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 group-hover:translate-x-1 transition-all\"");
html_body.push('>');
html_body.push('→');
html_body.push_str("</span>");
html_body.push_str("</a>");
html_body.push_str("<a");
html_body.push_str(" href=\"/about\"");
html_body.push_str(" class=\"px-8 py-4 rounded-full hover:bg-white/5 transition-colors font-medium text-gray-300\"");
html_body.push('>');
html_body.push_str("How it works\n                    ");
html_body.push_str("</a>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<!-- Stats / Social Proof -->");
html_body.push_str("<div");
html_body.push_str(" class=\"mt-24 grid grid-cols-2 md:grid-cols-4 gap-8 max-w-5xl mx-auto border-t border-white/10 pt-12\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"text-center\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"text-3xl font-bold text-white\"");
html_body.push('>');
html_body.push_str("2M+");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"text-sm text-gray-500 mt-1\"");
html_body.push('>');
html_body.push_str("Daily Matches");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"text-center\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"text-3xl font-bold text-white\"");
html_body.push('>');
html_body.push_str("4.9/5");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"text-sm text-gray-500 mt-1\"");
html_body.push('>');
html_body.push_str("App Store Rating");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"text-center\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"text-3xl font-bold text-white\"");
html_body.push('>');
html_body.push_str("100%");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"text-sm text-gray-500 mt-1\"");
html_body.push('>');
html_body.push_str("Verified Profiles");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"text-center\"");
html_body.push('>');
html_body.push_str("<div");
html_body.push_str(" class=\"text-3xl font-bold text-white\"");
html_body.push('>');
html_body.push_str("24/7");
html_body.push_str("</div>");
html_body.push_str("<div");
html_body.push_str(" class=\"text-sm text-gray-500 mt-1\"");
html_body.push('>');
html_body.push_str("Support Team");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</div>");
html_body.push_str("</main>");
html_body.push_str("</div>");
html_body.push_str("</body></html>");

    axum::response::Html(html_body).into_response()
}



        // Middleware Module Support
        

        // Logic Module Support
        #[path = "../logic/mod.rs"] pub mod logic;

        // Models Module Support
        

        use mimalloc::MiMalloc;
        #[global_allocator]
        static GLOBAL: MiMalloc = MiMalloc;

        #[tokio::main]
        async fn main() {
            // Initialize Database
            if std::path::Path::new("nucleus.db").exists() {
                 match nucleus_std::photon::init_db("sqlite:nucleus.db").await {
                     Ok(_) => println!("✅ Database initialized"),
                     Err(e) => eprintln!("❌ Database initialization failed: {}", e),
                 }
            }

            // Static Router with Zero-Allocation Assets
            let app = Router::new()
                .route("/discover", get(handle_discover)).route("/chat", get(handle_chat)).route("/profile", get(handle_profile)).route("/", get(handle_index))
                .nest_service("/pkg", ServeDir::new("static/pkg"))
                ;
                
            // Auto-Inject Middleware if `src/middleware.rs` exists
            let app = app;
            

            println!("⚛️  Nucleus Hyperdrive (AOT) running on http://0.0.0.0:3002");
            let listener = TcpListener::bind("0.0.0.0:3002").await.unwrap();
            axum::serve(listener, app).await.unwrap();
        }
        